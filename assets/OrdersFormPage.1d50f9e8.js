import{Q as j}from"./QPage.b0984c75.js";import{Q as Z}from"./QPageContainer.c63bcb34.js";import{a as T}from"./QLayout.171c6731.js";import{Q as B}from"./QSpace.41fc64f0.js";import{Q as k}from"./QSelect.d2bb26c1.js";import{s as L,Q as C}from"./QItemLabel.1e01a216.js";import{z as G,r as F,ab as K,an as M,o as z,h as W,G as Y,g as H,ac as J,y as D,B as X,a4 as ee,av as te,P as I,R as oe,a2 as m,S as w,U as N,V as x,W as u,j as s,_ as $,Y as R,F as se,aS as ae,aF as P,$ as S,Z as re,aT as O}from"./index.94fa42e8.js";import{_ as V}from"./DefaultInput.95b99efe.js";import{_ as le}from"./PhoneInput.b484b22c.js";import{u as ne}from"./orders.65f78035.js";import{u as ue}from"./vue-i18n.esm-bundler.61bc1595.js";import"./QImg.2154a7d2.js";import"./input.a9224496.js";var ie=G({name:"QForm",props:{autofocus:Boolean,noErrorFocus:Boolean,noResetFocus:Boolean,greedy:Boolean,onSubmit:Function},emits:["reset","validationSuccess","validationError"],setup(c,{slots:p,emit:y}){const a=H(),i=F(null);let r=0;const f=[];function _(e){const n=typeof e=="boolean"?e:c.noErrorFocus!==!0,b=++r,E=(l,d)=>{y("validation"+(l===!0?"Success":"Error"),d)},Q=l=>{const d=l.validate();return typeof d.then=="function"?d.then(v=>({valid:v,comp:l}),v=>({valid:!1,comp:l,err:v})):Promise.resolve({valid:d,comp:l})};return(c.greedy===!0?Promise.all(f.map(Q)).then(l=>l.filter(d=>d.valid!==!0)):f.reduce((l,d)=>l.then(()=>Q(d).then(v=>{if(v.valid===!1)return Promise.reject(v)})),Promise.resolve()).catch(l=>[l])).then(l=>{if(l===void 0||l.length===0)return b===r&&E(!0),!0;if(b===r){const{comp:d,err:v}=l[0];if(v!==void 0&&console.error(v),E(!1,d),n===!0){const U=l.find(({comp:A})=>typeof A.focus=="function"&&J(A.$)===!1);U!==void 0&&U.comp.focus()}}return!1})}function g(){r++,f.forEach(e=>{typeof e.resetValidation=="function"&&e.resetValidation()})}function q(e){e!==void 0&&D(e);const n=r+1;_().then(b=>{n===r&&b===!0&&(c.onSubmit!==void 0?y("submit",e):e!==void 0&&e.target!==void 0&&typeof e.target.submit=="function"&&e.target.submit())})}function h(e){e!==void 0&&D(e),y("reset"),X(()=>{g(),c.autofocus===!0&&c.noResetFocus!==!0&&o()})}function o(){L(()=>{if(i.value===null)return;const e=i.value.querySelector("[autofocus][tabindex], [data-autofocus][tabindex]")||i.value.querySelector("[autofocus] [tabindex], [data-autofocus] [tabindex]")||i.value.querySelector("[autofocus], [data-autofocus]")||Array.prototype.find.call(i.value.querySelectorAll("[tabindex]"),n=>n.tabIndex>-1);e!=null&&e.focus({preventScroll:!0})})}ee(te,{bindComponent(e){f.push(e)},unbindComponent(e){const n=f.indexOf(e);n>-1&&f.splice(n,1)}});let t=!1;return K(()=>{t=!0}),M(()=>{t===!0&&c.autofocus===!0&&o()}),z(()=>{c.autofocus===!0&&o()}),Object.assign(a.proxy,{validate:_,resetValidation:g,submit:q,reset:h,focus:o,getValidationComponents:()=>f}),()=>W("form",{class:"q-form",ref:i,onSubmit:q,onReset:h},Y(p.default))}});const de={class:"column no-wrap q-mb-md",style:{gap:"20px"}},me={class:"row no-wrap",style:{gap:"20px"}},ce={class:"column no-wrap q-mb-lg"},pe={class:"row"},fe={style:{"margin-right":"5%"}},ve={style:{width:"90%"},class:"column"},be={class:"column",style:{width:"10%"}},ye={class:"row no-wrap",style:{gap:"20px","justify-content":"space-between"}},ge={style:{width:"100%"}},xe={style:{width:"50%"}},_e={style:{width:"33%"}},qe=u("div",{style:{color:"#464A4D","font-size":"16px"}}," \u0421\u0443\u043C ",-1),he={class:"row q-mt-lg"},Ve=I({__name:"EditForm",setup(c){const{t:p}=ue(),y=oe(),a=ne(),i=F(!1),r=F({first_name:"",last_name:"",address:"",phone:"",email:""});z(()=>{a.products||a.getProducts()}),y.params.id&&a.orders&&f(y.params.id);function f(o){return a.orders.find(t=>t.order_number===o)}function _(){if(!i.value){O.create({color:"negative",position:"top-right",message:p("validation.fail")});return}O.create({color:"positive",textColor:"white",message:p("notification.orders.created"),position:"top-right"})}function g(o){return o?i.value=!0:(i.value=!1,p("validation.required"))}function q(o){return/^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}$/.test(o)?i.value=!0:(i.value=!1,p("validation.email"))}function h(o){const t=/\d/g,e=o.match(t);return(e?e.length:0)>8?i.value=!0:(i.value=!1,p("validation.required"))}return(o,t)=>m(a).products?(w(),N(ie,{key:0,class:"q-mt-md q-pa-xl column q-mx-auto bg-white",style:{"border-radius":"12px"}},{default:x(()=>[u("div",de,[u("div",me,[s(V,{rules:[g],name:"name",label:o.$t("orders.form.inputs.name"),text:r.value.first_name,"onUpdate:text":t[0]||(t[0]=e=>r.value.first_name=e),class:"full-width"},null,8,["rules","label","text"]),s(V,{rules:[g],name:"surname",label:o.$t("orders.form.inputs.surname"),text:r.value.last_name,"onUpdate:text":t[1]||(t[1]=e=>r.value.last_name=e),class:"full-width"},null,8,["rules","label","text"]),s(le,{rules:[h],class:"full-width",text:r.value.phone,"onUpdate:text":t[2]||(t[2]=e=>r.value.phone=e)},null,8,["rules","text"]),s(V,{rules:[g,q],name:"email",label:"Email",text:r.value.email,"onUpdate:text":t[3]||(t[3]=e=>r.value.email=e),class:"full-width"},null,8,["rules","text"])]),s(V,{rules:[g],name:"address",icon:"location_on",label:o.$t("orders.form.inputs.address"),text:r.value.address,"onUpdate:text":t[4]||(t[4]=e=>r.value.address=e)},null,8,["rules","label","text"])]),u("div",ce,[u("div",pe,[u("span",null,$(o.$t("orders.form.inputs.products")),1),s(B),u("span",fe,$(o.$t("orders.form.inputs.amount")),1)]),(w(!0),R(se,null,ae(m(a).selectedProducts,(e,n)=>(w(),R("div",{class:"row no-wrap q-mt-md",style:{gap:"20px"},key:n},[u("label",ve,[s(k,{"dropdown-icon":"expand_more",class:"q-px-md border-reset q-py-xs",dense:"",borderless:"",modelValue:m(a).selectedProducts[n],"onUpdate:modelValue":b=>m(a).selectedProducts[n]=b,options:m(a).mappedProducts},null,8,["modelValue","onUpdate:modelValue","options"])]),u("label",be,[s(C,{dense:"",borderless:"",class:"q-py-xs q-px-md border-reset full-wdith",type:"number",modelValue:m(a).selectedProducts[n].amount,"onUpdate:modelValue":b=>m(a).selectedProducts[n].amount=b},null,8,["modelValue","onUpdate:modelValue"])])]))),128)),s(P,{flat:"",icon:"add",onClick:t[5]||(t[5]=e=>m(a).addProduct()),label:o.$t("orders.form.addProducts"),"no-caps":"",style:{"align-self":"start","font-size":"14px"},class:"q-mt-md",color:"primary"},null,8,["label"])]),u("div",ye,[u("label",ge,[S($(o.$t("orders.form.inputs.status"))+" ",1),s(k,{"map-options":"","dropdown-icon":"expand_more",dense:"",color:"primary",class:"q-py-xs q-px-md q-mt-sm border-reset",borderless:"",modelValue:m(a).statusValalue,"onUpdate:modelValue":t[6]||(t[6]=e=>m(a).statusValalue=e),options:m(a).statusOptions},null,8,["modelValue","options"])]),u("label",xe,[S(" \u0412\u0440\u0435\u043C\u044F \u0437\u0430\u043A\u0430\u0437\u0430 "),s(C,{dense:"",borderless:"",class:"q-py-xs q-px-md q-mt-sm border-reset",type:"date",modelValue:o.orderDate,"onUpdate:modelValue":t[7]||(t[7]=e=>o.orderDate=e)},null,8,["modelValue"])]),u("label",_e,[S(" \u041E\u0431\u0449\u044F\u044F \u0446\u0435\u043D\u0430 "),s(C,{dense:"","clear-icon":"",borderless:"",class:"q-py-xs q-px-md q-mt-sm border-reset",type:"number",modelValue:o.price,"onUpdate:modelValue":t[8]||(t[8]=e=>o.price=e)},{append:x(()=>[qe]),_:1},8,["modelValue"])])]),u("div",he,[s(B),s(P,{color:"indigo-10",flat:"",label:o.$t("btn.cancel"),onClick:t[9]||(t[9]=e=>o.$router.go(-1)),style:{"border-radius":"12px"},class:"q-py-sm bg-grey-2 q-px-xl q-mr-md","no-caps":""},null,8,["label"]),s(P,{onClick:t[10]||(t[10]=e=>_()),color:"white",flat:"",label:o.$t("btn.save"),style:{"border-radius":"12px"},class:"q-py-sm q-px-xl bg-indigo-10","no-caps":""},null,8,["label"])])]),_:1})):re("",!0)}}),we={class:"text-h5 text-weight-bold"},ze=I({__name:"OrdersFormPage",setup(c){return(p,y)=>(w(),N(T,null,{default:x(()=>[s(Z,null,{default:x(()=>[s(j,{class:"q-pa-md main__container"},{default:x(()=>[u("h1",we,$(p.$route.path.includes("create")?"\u0414\u043E\u0431\u0430\u0432\u0438\u0442\u044C":"\u0418\u0437\u043C\u0435\u043D\u0438\u0442\u044C"),1),s(Ve)]),_:1})]),_:1})]),_:1}))}});export{ze as default};
